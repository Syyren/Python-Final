{% extends 'index.html' %}

{% block content %}
<!--graph selection-->
<select id="graphSelector" onchange="loadGraph()">
    <option value="genre_graph">Top 10 Genres</option>
    <option value="rating_distribution_graph">Content Distribution by Ratings</option>
    <option value="trend_graph">Trend of Additions Over the Years</option>
    <option value="top_countries_graph">Top 10 Countries with Most Content</option>
</select>

<div id="graphContainer">
    <!--default genre_graph-->
    {% include 'genre_graph.html' %}
</div>

<script>
function loadGraph() {
    var selectedGraph = document.getElementById("graphSelector").value;  // Get the selected graph option
    
    //uses option value to call graph from api
    var graphUrl = `/${selectedGraph}/`;

    //grabbing graph image
    fetch(graphUrl)
        .then(response => response.blob())
        .then(imageBlob => {
            var imageUrl = URL.createObjectURL(imageBlob);
            var graphContainer = document.getElementById('graphContainer');
            
            //clearing old graph before replacing
            graphContainer.innerHTML = '';
            
            var img = document.createElement('img');
            img.src = imageUrl;
            img.alt = selectedGraph;
            //image responsiveness
            img.style.maxWidth = '100%';

            //adding graph to graph container
            graphContainer.appendChild(img);
        })
        .catch(error => {
            console.error('Error fetching graph:', error);
        });
}


//fixing issue caused by reloading page
window.onload = function() {
    //setting dropdown to be genre graph because it's the one that loads in first
    document.getElementById("graphSelector").value = "genre_graph";
};

</script>
{% endblock content %}
